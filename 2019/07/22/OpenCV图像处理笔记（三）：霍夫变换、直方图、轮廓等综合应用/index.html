<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>OpenCV图像处理笔记（三）：霍夫变换、直方图、轮廓等综合应用 | MiChong的🏡</title><meta name="keywords" content="C++,OpenCV"><meta name="author" content="MiChong,qjzxzxd@gmail.com"><meta name="copyright" content="MiChong"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、霍夫直线变换1、霍夫直线变换 Hough Line Transform用来做直线检测 前提条件 – 边缘检测已经完成 平面空间到极坐标空间转换  2、霍夫直线变换介绍 对于任意一条直线上的所有点来说 变换到极坐标中，从[0~360]空间，可以得到r的大小 属于同一条直线上点在极坐标空(r, theta)必然在一个点上有最强的信号出现，根据此反算到平面坐标中就可以得到直线上各点的像素坐标。从而得">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCV图像处理笔记（三）：霍夫变换、直方图、轮廓等综合应用">
<meta property="og:url" content="https://www.buildworld.cn/2019/07/22/OpenCV%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E3%80%81%E8%BD%AE%E5%BB%93%E7%AD%89%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/index.html">
<meta property="og:site_name" content="MiChong的🏡">
<meta property="og:description" content="一、霍夫直线变换1、霍夫直线变换 Hough Line Transform用来做直线检测 前提条件 – 边缘检测已经完成 平面空间到极坐标空间转换  2、霍夫直线变换介绍 对于任意一条直线上的所有点来说 变换到极坐标中，从[0~360]空间，可以得到r的大小 属于同一条直线上点在极坐标空(r, theta)必然在一个点上有最强的信号出现，根据此反算到平面坐标中就可以得到直线上各点的像素坐标。从而得">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://file.buildworld.cn/img/opencv.png">
<meta property="article:published_time" content="2019-07-22T01:46:12.000Z">
<meta property="article:modified_time" content="2020-05-05T07:14:48.000Z">
<meta property="article:author" content="MiChong">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="OpenCV">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://file.buildworld.cn/img/opencv.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.buildworld.cn/2019/07/22/OpenCV%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E3%80%81%E8%BD%AE%E5%BB%93%E7%AD%89%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OpenCV图像处理笔记（三）：霍夫变换、直方图、轮廓等综合应用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-05-05 15:14:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="MiChong的🏡" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/header.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">71</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">69</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/talk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 歌单</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 影单</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-rocket"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://file.buildworld.cn/img/opencv.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MiChong的🏡</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/talk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 歌单</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 影单</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-images"></i><span> 图集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-rocket"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">OpenCV图像处理笔记（三）：霍夫变换、直方图、轮廓等综合应用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-07-22T01:46:12.000Z" title="发表于 2019-07-22 09:46:12">2019-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-05-05T07:14:48.000Z" title="更新于 2020-05-05 15:14:48">2020-05-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="OpenCV图像处理笔记（三）：霍夫变换、直方图、轮廓等综合应用"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h4 id="一、霍夫直线变换"><a href="#一、霍夫直线变换" class="headerlink" title="一、霍夫直线变换"></a>一、霍夫直线变换</h4><h5 id="1、霍夫直线变换"><a href="#1、霍夫直线变换" class="headerlink" title="1、霍夫直线变换"></a>1、霍夫直线变换</h5><ul>
<li>Hough Line Transform用来做直线检测</li>
<li>前提条件 – 边缘检测已经完成</li>
<li>平面空间到极坐标空间转换</li>
</ul>
<h5 id="2、霍夫直线变换介绍"><a href="#2、霍夫直线变换介绍" class="headerlink" title="2、霍夫直线变换介绍"></a>2、霍夫直线变换介绍</h5><ul>
<li>对于任意一条直线上的所有点来说</li>
<li>变换到极坐标中，从[0~360]空间，可以得到r的大小</li>
<li>属于同一条直线上点在极坐标空(r, theta)必然在一个点上有最强的信号出现，根据此反算到平面坐标中就可以得到直线上各点的像素坐标。从而得到直线</li>
</ul>
<h5 id="3、相关API"><a href="#3、相关API" class="headerlink" title="3、相关API"></a>3、相关API</h5><ul>
<li>标准的霍夫变换 cv::HoughLines从平面坐标转换到霍夫空间，最终输出是               表示极坐标空间</li>
<li>霍夫变换直线概率 cv::HoughLinesP最终输出是直线的两个点</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cv::<span class="built_in">HoughLinesP</span>(</span><br><span class="line">InputArray src, <span class="comment">// 输入图像，必须8-bit的灰度图像</span></span><br><span class="line">OutputArray lines, <span class="comment">// 输出的极坐标来表示直线</span></span><br><span class="line"><span class="keyword">double</span> rho, <span class="comment">// 生成极坐标时候的像素扫描步长</span></span><br><span class="line"><span class="keyword">double</span> theta, <span class="comment">//生成极坐标时候的角度步长，一般取值CV_PI/180</span></span><br><span class="line"><span class="keyword">int</span> threshold, <span class="comment">// 阈值，只有获得足够交点的极坐标点才被看成是直线</span></span><br><span class="line"><span class="keyword">double</span> minLineLength=<span class="number">0</span>;<span class="comment">// 最小直线长度</span></span><br><span class="line"><span class="keyword">double</span> maxLineGap=<span class="number">0</span>;<span class="comment">// 最大间隔</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">   Mat src, src_gray,dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\线条.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//边缘检测</span></span><br><span class="line"><span class="built_in">Canny</span>(src, src_gray, <span class="number">150</span>, <span class="number">200</span>);</span><br><span class="line"><span class="comment">//灰度转彩色</span></span><br><span class="line"><span class="built_in">cvtColor</span>(src_gray, dst, CV_GRAY2BGR);</span><br><span class="line"></span><br><span class="line"><span class="comment">//霍夫直线检测</span></span><br><span class="line">vector&lt;Vec4f&gt; plines;</span><br><span class="line"><span class="built_in">HoughLinesP</span>(src_gray, plines, <span class="number">1</span>, CV_PI / <span class="number">180.0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; plines.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">	Vec4f hline = plines[i];</span><br><span class="line">	<span class="built_in">line</span>(dst, <span class="built_in">Point</span>(hline[i], hline[<span class="number">1</span>]), <span class="built_in">Point</span>(hline[<span class="number">2</span>], hline[<span class="number">3</span>]), color,<span class="number">3</span>, LINE_AA);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;dst img&quot;</span>, dst);</span><br></pre></td></tr></table></figure>
<h4 id="二、霍夫圆检测"><a href="#二、霍夫圆检测" class="headerlink" title="二、霍夫圆检测"></a>二、霍夫圆检测</h4><h5 id="1、原理"><a href="#1、原理" class="headerlink" title="1、原理"></a>1、原理</h5><p><img src="http://myfile.buildworld.cn/%E9%9C%8D%E5%A4%AB%E5%9C%86%E6%A3%80%E6%B5%8B%E5%8E%9F%E7%90%86.png" alt="原理"><br><img src="http://myfile.buildworld.cn/%E9%9C%8D%E5%A4%AB%E5%9C%86%E6%A3%80%E6%B5%8B%E5%8E%9F%E7%90%862.png" alt="image"></p>
<h5 id="2、相关API-cv-HoughCircles"><a href="#2、相关API-cv-HoughCircles" class="headerlink" title="2、相关API cv::HoughCircles"></a>2、相关API cv::HoughCircles</h5><ul>
<li>因为霍夫圆检测对噪声比较敏感，所以首先要对图像做中值滤波。</li>
<li>基于效率考虑，Opencv中实现的霍夫变换圆检测是基于图像梯度的实现，分为两步：<ol>
<li>检测边缘，发现可能的圆心</li>
<li>基于第一步的基础上从候选圆心开始计算最佳半径大小</li>
</ol>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">HoughCircles</span>(</span><br><span class="line">InputArray image, <span class="comment">// 输入图像 ,必须是8位的单通道灰度图像</span></span><br><span class="line">OutputArray circles, <span class="comment">// 输出结果，发现的圆信息</span></span><br><span class="line">Int method, <span class="comment">// 方法 - HOUGH_GRADIENT</span></span><br><span class="line">Double dp, <span class="comment">// dp = 1; </span></span><br><span class="line">Double mindist, <span class="comment">// 10 最短距离-可以分辨是两个圆的，否则认为是同心圆- src_gray.rows/8</span></span><br><span class="line">Double param1, <span class="comment">// canny edge detection low threshold</span></span><br><span class="line">Double param2, <span class="comment">// 中心点累加器阈值 – 候选圆心</span></span><br><span class="line">Int minradius, <span class="comment">// 最小半径</span></span><br><span class="line">Int maxradius<span class="comment">//最大半径 </span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Mat src, dst;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\Administrator\\Pictures\\霍夫圆检测4.jpg&quot;</span>);</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;src img&quot;</span>, src);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//中值滤波转灰度</span></span><br><span class="line">	Mat mediaImg;</span><br><span class="line">	<span class="built_in">medianBlur</span>(src, mediaImg, <span class="number">3</span>);</span><br><span class="line">	<span class="built_in">cvtColor</span>(mediaImg, mediaImg, CV_BGR2GRAY);</span><br><span class="line">	<span class="built_in">GaussianBlur</span>(mediaImg,mediaImg, <span class="built_in">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//霍夫圆检测</span></span><br><span class="line">	vector&lt;Vec3f&gt; pcircle;</span><br><span class="line">	<span class="built_in">HoughCircles</span>(mediaImg, pcircle, CV_HOUGH_GRADIENT, <span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">50</span>);</span><br><span class="line">	src.<span class="built_in">copyTo</span>(dst);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; pcircle.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Vec3f cc = pcircle[i];</span><br><span class="line">		<span class="comment">//圆形标注</span></span><br><span class="line">		<span class="built_in">circle</span>(dst, <span class="built_in">Point</span>(cc[<span class="number">0</span>], cc[<span class="number">1</span>]), cc[<span class="number">2</span>], <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">2</span>, LINE_AA);</span><br><span class="line">		<span class="comment">//圆心标注</span></span><br><span class="line">		<span class="built_in">circle</span>(dst, <span class="built_in">Point</span>(cc[<span class="number">0</span>], cc[<span class="number">1</span>]), <span class="number">2</span>, <span class="built_in">Scalar</span>(<span class="number">198</span>, <span class="number">50</span>, <span class="number">255</span>), <span class="number">2</span>, LINE_AA);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;hough img&quot;</span>, dst);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="三、像素重映射"><a href="#三、像素重映射" class="headerlink" title="三、像素重映射"></a>三、像素重映射</h4><h5 id="1、原理-1"><a href="#1、原理-1" class="headerlink" title="1、原理"></a>1、原理</h5><blockquote>
<p>简单点说就是把输入图像中各个像素按照一定的规则映射到另外一张图像的对应位置上去，形成一张新的图像。</p>
</blockquote>
<h5 id="2、API介绍cv-remap"><a href="#2、API介绍cv-remap" class="headerlink" title="2、API介绍cv::remap"></a>2、API介绍cv::remap</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Remap</span>(</span><br><span class="line">InputArray src,<span class="comment">// 输入图像</span></span><br><span class="line">OutputArray dst,<span class="comment">// 输出图像</span></span><br><span class="line">InputArray  map1,<span class="comment">// x 映射表 CV_32FC1/CV_32FC2</span></span><br><span class="line">InputArray map2,<span class="comment">// y 映射表</span></span><br><span class="line"><span class="keyword">int</span> interpolation,<span class="comment">// 选择的插值方法，常见线性插值，可选择立方等</span></span><br><span class="line"><span class="keyword">int</span> borderMode,<span class="comment">// BORDER_CONSTANT</span></span><br><span class="line"><span class="keyword">const</span> Scalar borderValue<span class="comment">// color </span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="示例代码-1"><a href="#示例代码-1" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst, map_x, map_y;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* OUTPUT_TITLE = <span class="string">&quot;remap demo&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_map</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\Administrator\\Pictures\\girl2.jpg&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;could not load image...\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">char</span> input_win[] = <span class="string">&quot;input image&quot;</span>;</span><br><span class="line">	<span class="built_in">namedWindow</span>(input_win, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(OUTPUT_TITLE, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">imshow</span>(input_win, src);</span><br><span class="line"></span><br><span class="line">	map_x.<span class="built_in">create</span>(src.<span class="built_in">size</span>(), CV_32FC1);</span><br><span class="line">	map_y.<span class="built_in">create</span>(src.<span class="built_in">size</span>(), CV_32FC1);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">		c = <span class="built_in">waitKey</span>(<span class="number">500</span>);</span><br><span class="line">		<span class="comment">//按住esc退出</span></span><br><span class="line">		<span class="keyword">if</span> ((<span class="keyword">char</span>)c == <span class="number">27</span>) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//键盘输入1,2,3,4</span></span><br><span class="line">		index = c % <span class="number">4</span>;</span><br><span class="line">		<span class="built_in">update_map</span>();</span><br><span class="line">		<span class="built_in">remap</span>(src, dst, map_x, map_y, INTER_LINEAR, BORDER_CONSTANT, <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>));</span><br><span class="line">		<span class="built_in">imshow</span>(OUTPUT_TITLE, dst);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_map</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; src.rows; row++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; src.cols; col++) &#123;</span><br><span class="line">			<span class="built_in"><span class="keyword">switch</span></span> (index) &#123;</span><br><span class="line">			<span class="comment">//缩小一半</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">if</span> (col &gt;(src.cols * <span class="number">0.25</span>) &amp;&amp; col &lt;= (src.cols*<span class="number">0.75</span>) &amp;&amp; row &gt;(src.rows*<span class="number">0.25</span>) &amp;&amp; row &lt;= (src.rows*<span class="number">0.75</span>)) &#123;</span><br><span class="line">					map_x.at&lt;<span class="keyword">float</span>&gt;(row, col) = <span class="number">2</span> * (col - (src.cols*<span class="number">0.25</span>));</span><br><span class="line">					map_y.at&lt;<span class="keyword">float</span>&gt;(row, col) = <span class="number">2</span> * (row - (src.rows*<span class="number">0.25</span>));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					map_x.at&lt;<span class="keyword">float</span>&gt;(row, col) = <span class="number">0</span>;</span><br><span class="line">					map_y.at&lt;<span class="keyword">float</span>&gt;(row, col) = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="comment">//x方向对调</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				map_x.at&lt;<span class="keyword">float</span>&gt;(row, col) = (src.cols - col - <span class="number">1</span>);</span><br><span class="line">				map_y.at&lt;<span class="keyword">float</span>&gt;(row, col) = row;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="comment">//y方向对调</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				map_x.at&lt;<span class="keyword">float</span>&gt;(row, col) = col;</span><br><span class="line">				map_y.at&lt;<span class="keyword">float</span>&gt;(row, col) = (src.rows - row - <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="comment">//x,y方向都对调</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				map_x.at&lt;<span class="keyword">float</span>&gt;(row, col) = (src.cols - col - <span class="number">1</span>);</span><br><span class="line">				map_y.at&lt;<span class="keyword">float</span>&gt;(row, col) = (src.rows - row - <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="四、直方图-histogram"><a href="#四、直方图-histogram" class="headerlink" title="四、直方图 (histogram)"></a>四、直方图 (histogram)</h4><h5 id="1、直方图均衡化概念"><a href="#1、直方图均衡化概念" class="headerlink" title="1、直方图均衡化概念"></a>1、直方图均衡化概念</h5><blockquote>
<p>图像直方图，是指对整个图像像在灰度范围内的像素值(0~255)统计出现频率次数，据此生成的直方图，称为图像直方图-直方图。直方图反映了图像灰度的分布情况。是图像的统计学特征。</p>
</blockquote>
<h5 id="2、直方图均衡化"><a href="#2、直方图均衡化" class="headerlink" title="2、直方图均衡化"></a>2、直方图均衡化</h5><blockquote>
<p>是一种提高图像对比度的方法，拉伸图像灰度值范围。</p>
</blockquote>
<blockquote>
<p>如何实现，通过上一课中的remap我们知道可以将图像灰度分布从一个分布映射到另外一个分布，然后在得到映射后的像素值即可。</p>
</blockquote>
<h5 id="3、直方图均衡化API说明cv-equalizeHist"><a href="#3、直方图均衡化API说明cv-equalizeHist" class="headerlink" title="3、直方图均衡化API说明cv::equalizeHist"></a>3、直方图均衡化API说明cv::equalizeHist</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">equalizeHist</span>(</span><br><span class="line">InputArray src,<span class="comment">//输入图像，必须是8-bit的单通道图像</span></span><br><span class="line">OutputArray dst<span class="comment">// 输出结果</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="4、直方图计算"><a href="#4、直方图计算" class="headerlink" title="4、直方图计算"></a>4、直方图计算</h5><ul>
<li>上述直方图概念是基于图像像素值，其实对图像梯度、每个像素的角度、等一切图像的属性值，我们都可以建立直方图。这个才是直方图的概念真正意义，不过是基于图像像素灰度直方图是最常见的。</li>
<li>直方图最常见的几个属性：<ul>
<li>dims 表示维度，对灰度图像来说只有一个通道值dims=1</li>
<li>bins 表示在维度中子区域大小划分，bins=256，划分为256个级别</li>
<li>range 表示值得范围，灰度值范围为[0~255]之间</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">split</span>(<span class="comment">// 把多通道图像分为多个单通道图像</span></span><br><span class="line"><span class="keyword">const</span> Mat &amp;src, <span class="comment">//输入图像</span></span><br><span class="line">Mat* mvbegin）<span class="comment">// 输出的通道图像数组</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">calcHist</span>(</span><br><span class="line"> <span class="keyword">const</span> Mat* images,<span class="comment">//输入图像指针</span></span><br><span class="line"><span class="keyword">int</span> images,<span class="comment">// 图像数目</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>* channels,<span class="comment">// 通道数</span></span><br><span class="line">InputArray mask,<span class="comment">// 输入mask，可选，不用</span></span><br><span class="line">OutputArray hist,<span class="comment">//输出的直方图数据</span></span><br><span class="line"><span class="keyword">int</span> dims,<span class="comment">// 维数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>* histsize,<span class="comment">// 直方图级数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">float</span>* ranges,<span class="comment">// 值域范围</span></span><br><span class="line"><span class="keyword">bool</span> uniform,<span class="comment">// true by default</span></span><br><span class="line"><span class="keyword">bool</span> accumulate<span class="comment">// false by defaut</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>


<h5 id="4、直方图比较方法-概述"><a href="#4、直方图比较方法-概述" class="headerlink" title="4、直方图比较方法-概述"></a>4、直方图比较方法-概述</h5><blockquote>
<p>对输入的两张图像计算得到直方图H1与H2，归一化到相同的尺度空间<br>然后可以通过计算H1与H2的之间的距离得到两个直方图的相似程度进<br>而比较图像本身的相似程度。</p>
</blockquote>
<blockquote>
<p>Opencv提供的比较方法有四种：</p>
</blockquote>
<ul>
<li>Correlation 相关性比较(CV_COMP_CORREL)</li>
<li>Chi-Square 卡方比较(CV_COMP_CHISQR)</li>
<li>Intersection 十字交叉性(CV_COMP_INTERSECT)</li>
<li>Bhattacharyya distance 巴氏距离(CV_COMP_BHATTACHARYYA )<h5 id="相关API"><a href="#相关API" class="headerlink" title="相关API"></a>相关API</h5></li>
<li>首先把图像从RGB色彩空间转换到HSV色彩空间cvtColor</li>
<li>计算图像的直方图，然后归一化到[0~1]之间calcHist和normalize;</li>
<li>使用上述四种比较方法之一进行比较compareHist<h6 id="相关API-cv-compareHist"><a href="#相关API-cv-compareHist" class="headerlink" title="相关API cv::compareHist"></a>相关API cv::compareHist</h6></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compareHist(</span><br><span class="line">InputArray h1, // 直方图数据，下同</span><br><span class="line">InputArray H2,</span><br><span class="line">int method// 比较方法，上述四种方法之一</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h6 id="示例代码-2"><a href="#示例代码-2" class="headerlink" title="示例代码"></a>示例代码</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Mat src, dst;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\刘亦菲.jpg&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//分通道显示</span></span><br><span class="line">	vector&lt;Mat&gt; bgr_planes;</span><br><span class="line">	<span class="built_in">split</span>(src, bgr_planes);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> histSize = <span class="number">256</span>;</span><br><span class="line">	<span class="keyword">float</span> range[] = &#123; <span class="number">0</span>,<span class="number">256</span> &#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">float</span> *histRange = &#123; range &#125;;</span><br><span class="line">	Mat b_hist, g_hist, r_hist;</span><br><span class="line">	<span class="built_in">calcHist</span>(&amp;bgr_planes[<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">Mat</span>(), b_hist, <span class="number">1</span>, &amp;histSize, &amp;histRange, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">calcHist</span>(&amp;bgr_planes[<span class="number">1</span>], <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">Mat</span>(), g_hist, <span class="number">1</span>, &amp;histSize, &amp;histRange, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">calcHist</span>(&amp;bgr_planes[<span class="number">2</span>], <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">Mat</span>(), r_hist, <span class="number">1</span>, &amp;histSize, &amp;histRange, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//归一化</span></span><br><span class="line">	<span class="keyword">int</span> hist_h = <span class="number">200</span>;</span><br><span class="line">	<span class="keyword">int</span> hist_w = <span class="number">300</span>;</span><br><span class="line">	<span class="keyword">int</span> bin_w = hist_w / histSize;</span><br><span class="line">	<span class="function">Mat <span class="title">histImage</span><span class="params">(hist_w, hist_h, CV_8UC3, Scalar(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span></span>;</span><br><span class="line">	<span class="built_in">normalize</span>(b_hist, b_hist, <span class="number">0</span>, hist_h, NORM_MINMAX, <span class="number">-1</span>, <span class="built_in">Mat</span>());</span><br><span class="line">	<span class="built_in">normalize</span>(g_hist, g_hist, <span class="number">0</span>, hist_h, NORM_MINMAX, <span class="number">-1</span>, <span class="built_in">Mat</span>());</span><br><span class="line">	<span class="built_in">normalize</span>(r_hist, r_hist, <span class="number">0</span>, hist_h, NORM_MINMAX, <span class="number">-1</span>, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	<span class="comment">//绘制直方图</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; histSize; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">line</span>(histImage, <span class="built_in">Point</span>((i - <span class="number">1</span>)*bin_w, hist_h - <span class="built_in">cvRound</span>(b_hist.at&lt;<span class="keyword">float</span>&gt;(i - <span class="number">1</span>))),</span><br><span class="line">			<span class="built_in">Point</span>((i)*bin_w, hist_h - <span class="built_in">cvRound</span>(b_hist.at&lt;<span class="keyword">float</span>&gt;(i))), <span class="built_in">Scalar</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), LINE_AA);</span><br><span class="line">		<span class="built_in">line</span>(histImage, <span class="built_in">Point</span>((i - <span class="number">1</span>)*bin_w, hist_h - <span class="built_in">cvRound</span>(g_hist.at&lt;<span class="keyword">float</span>&gt;(i - <span class="number">1</span>))),</span><br><span class="line">			<span class="built_in">Point</span>((i)*bin_w, hist_h - <span class="built_in">cvRound</span>(g_hist.at&lt;<span class="keyword">float</span>&gt;(i))), <span class="built_in">Scalar</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), LINE_AA);</span><br><span class="line">		<span class="built_in">line</span>(histImage, <span class="built_in">Point</span>((i - <span class="number">1</span>)*bin_w, hist_h - <span class="built_in">cvRound</span>(r_hist.at&lt;<span class="keyword">float</span>&gt;(i - <span class="number">1</span>))),</span><br><span class="line">			<span class="built_in">Point</span>((i)*bin_w, hist_h - <span class="built_in">cvRound</span>(r_hist.at&lt;<span class="keyword">float</span>&gt;(i))), <span class="built_in">Scalar</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), LINE_AA);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;src img&quot;</span>, histImage);</span><br></pre></td></tr></table></figure>

<h5 id="5、直方图反向投影-Back-Projection"><a href="#5、直方图反向投影-Back-Projection" class="headerlink" title="5、直方图反向投影(Back Projection)"></a>5、直方图反向投影(Back Projection)</h5><ul>
<li>反向投影是反映直方图模型在目标图像中的分布情况</li>
<li>简单点说就是用直方图模型去目标图像中寻找是否有相似的对象。通常用HSV色彩空间的HS两个通道直方图模型</li>
</ul>
<h6 id="反向投影-–-步骤"><a href="#反向投影-–-步骤" class="headerlink" title="反向投影 – 步骤"></a>反向投影 – 步骤</h6><ul>
<li>1.建立直方图模型</li>
<li>2.计算待测图像直方图并映射到模型中</li>
<li>3.从模型反向计算生成图像</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">加载图片imread</span><br><span class="line">将图像从RGB色彩空间转换到HSV色彩空间cvtColor</span><br><span class="line">计算直方图和归一化calcHist与normalize</span><br><span class="line">Mat与MatND其中Mat表示二维数组，MatND表示三维或者多维数据，此处均可以用Mat表示。</span><br><span class="line">计算反向投影图像 - calcBackProject</span><br><span class="line"></span><br><span class="line">Mat src, hsv, hue;</span><br><span class="line"><span class="keyword">int</span> bins = <span class="number">12</span>;</span><br><span class="line">string src_img = <span class="string">&quot;src img&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hist_Add_Backproject</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\lab\\test1.png&quot;</span>);</span><br><span class="line">	<span class="built_in">namedWindow</span>(src_img, WINDOW_AUTOSIZE);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cvtColor</span>(src, hsv, CV_BGR2HSV);</span><br><span class="line">	hue.<span class="built_in">create</span>(hsv.<span class="built_in">size</span>(), hsv.<span class="built_in">depth</span>());</span><br><span class="line">	<span class="keyword">int</span> nchannels[] = &#123; <span class="number">0</span>,<span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">mixChannels</span>(&amp;hsv, <span class="number">1</span>, &amp;hue, <span class="number">1</span>, nchannels, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;Histogram Bins&quot;</span>, src_img, &amp;bins, <span class="number">180</span>, Hist_Add_Backproject);</span><br><span class="line">	<span class="built_in">Hist_Add_Backproject</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(src_img, src);</span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hist_Add_Backproject</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">float</span> range[] = &#123; <span class="number">0</span>,<span class="number">180</span> &#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">float</span> *histRanges = &#123; range &#125;;</span><br><span class="line">	Mat h_hist;</span><br><span class="line">	<span class="built_in">calcHist</span>(&amp;hue, <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">Mat</span>(), h_hist, <span class="number">1</span>, &amp;bins, &amp;histRanges, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">normalize</span>(h_hist, h_hist, <span class="number">0</span>, <span class="number">255</span>, NORM_MINMAX, <span class="number">-1</span>, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	Mat backPrjImage;</span><br><span class="line">	<span class="built_in">calcBackProject</span>(&amp;hue, <span class="number">1</span>, <span class="number">0</span>, h_hist, backPrjImage, &amp;histRanges, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;BackProj&quot;</span>, backPrjImage);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> hist_h = <span class="number">400</span>;</span><br><span class="line">	<span class="keyword">int</span> hist_w = <span class="number">400</span>;</span><br><span class="line">	<span class="function">Mat <span class="title">histImage</span><span class="params">(hist_w, hist_h, CV_8UC3, Scalar(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span></span>;</span><br><span class="line">	<span class="keyword">int</span> bin_w = <span class="built_in">cvRound</span>((<span class="keyword">double</span>)hist_w / bins);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; bins; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">rectangle</span>(histImage,</span><br><span class="line">			<span class="built_in">Point</span>((i - <span class="number">1</span>)*bin_w, (hist_h - <span class="built_in">cvRound</span>(h_hist.at&lt;<span class="keyword">float</span>&gt;(i - <span class="number">1</span>)*(<span class="number">400</span> / <span class="number">255</span>)))),</span><br><span class="line">			<span class="built_in">Point</span>(i*bin_w, hist_h),</span><br><span class="line">			<span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;Histogram&quot;</span>, histImage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="五、模板匹配-Template-Match"><a href="#五、模板匹配-Template-Match" class="headerlink" title="五、模板匹配(Template Match)"></a>五、模板匹配(Template Match)</h4><h5 id="1、模板匹配介绍"><a href="#1、模板匹配介绍" class="headerlink" title="1、模板匹配介绍"></a>1、模板匹配介绍</h5><ul>
<li>模板匹配就是在整个图像区域发现与给定子图像匹配的小块区域。</li>
<li>所以模板匹配首先需要一个模板图像T（给定的子图像）</li>
<li>另外需要一个待检测的图像-源图像S</li>
<li>工作方法，在带检测图像上，从左到右，从上向下计算模板图像与重叠子图像的匹配度，匹配程度越大，两者相同的可能性越大。</li>
</ul>
<h5 id="2、模板匹配介绍-–-匹配算法介绍"><a href="#2、模板匹配介绍-–-匹配算法介绍" class="headerlink" title="2、模板匹配介绍 – 匹配算法介绍"></a>2、模板匹配介绍 – 匹配算法介绍</h5><p><img src="http://myfile.buildworld.cn/%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95.jpg" alt="image"></p>
<h5 id="3、相关API介绍cv-matchTemplate"><a href="#3、相关API介绍cv-matchTemplate" class="headerlink" title="3、相关API介绍cv::matchTemplate"></a>3、相关API介绍cv::matchTemplate</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">matchTemplate</span>(</span><br><span class="line">    InputArray image,<span class="comment">// 源图像，必须是8-bit或者32-bit浮点数图像</span></span><br><span class="line">    </span><br><span class="line">    InputArray templ,<span class="comment">// 模板图像，类型与输入图像一致</span></span><br><span class="line">    </span><br><span class="line">    OutputArray result,<span class="comment">// 输出结果，必须是单通道32位浮点数，假设源图像WxH,模板图像wxh,</span></span><br><span class="line">    	             则结果必须为W-w+<span class="number">1</span>, H-h+<span class="number">1</span>的大小。</span><br><span class="line">    <span class="keyword">int</span> method,<span class="comment">//使用的匹配方法</span></span><br><span class="line">    </span><br><span class="line">    InputArray mask=<span class="built_in">noArray</span>()<span class="comment">//(optional)</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="示例代码-3"><a href="#示例代码-3" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst, temp;</span><br><span class="line"><span class="keyword">int</span> match_method = CV_TM_SQDIFF;</span><br><span class="line"><span class="keyword">int</span> max_track = <span class="number">5</span>;</span><br><span class="line">string inputImg = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string outputImg = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line">string matchimg = <span class="string">&quot;template match-demo&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Match_Demo</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\雷军.jpg&quot;</span>);</span><br><span class="line">	temp = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\雷军头像.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">namedWindow</span>(inputImg, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(outputImg, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(matchimg, CV_WINDOW_AUTOSIZE);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(inputImg, src);</span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;Macth Control&quot;</span>, inputImg, &amp;match_method, max_track, Match_Demo);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Match_Demo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Match_Demo</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> width = src.cols - temp.cols + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> height = src.rows - temp.rows + <span class="number">1</span>;</span><br><span class="line">	<span class="function">Mat <span class="title">result</span><span class="params">(width, height, CV_32FC1)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">matchTemplate</span>(src,temp,result,match_method,<span class="built_in">Mat</span>());</span><br><span class="line">	<span class="built_in">normalize</span>(result, result, <span class="number">0</span>, <span class="number">1</span>, NORM_MINMAX, <span class="number">-1</span>, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	Point minLoc;</span><br><span class="line">	Point maxLoc;</span><br><span class="line">	<span class="keyword">double</span> min, max;</span><br><span class="line">	src.<span class="built_in">copyTo</span>(dst);</span><br><span class="line">	Point tenLoc;</span><br><span class="line">	<span class="built_in">minMaxLoc</span>(result, &amp;min, &amp;max, &amp;minLoc, &amp;maxLoc, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (match_method==CV_TM_SQDIFF || match_method == CV_TM_SQDIFF_NORMED)</span><br><span class="line">	&#123;</span><br><span class="line">		tenLoc = minLoc;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		tenLoc = maxLoc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//绘制矩形</span></span><br><span class="line">	<span class="built_in">rectangle</span>(dst, <span class="built_in">Rect</span>(tenLoc.x, tenLoc.y, temp.cols, temp.rows), <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">.255</span>), <span class="number">2</span>, <span class="number">8</span>);</span><br><span class="line">	<span class="built_in">rectangle</span>(result, <span class="built_in">Rect</span>(tenLoc.x, tenLoc.y, temp.cols, temp.rows), <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">.255</span>), <span class="number">2</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(outputImg, result);</span><br><span class="line">	<span class="built_in">imshow</span>(matchimg, dst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="六、轮廓发现-find-contour-in-your-image"><a href="#六、轮廓发现-find-contour-in-your-image" class="headerlink" title="六、轮廓发现(find contour in your image)"></a>六、轮廓发现(find contour in your image)</h4><ul>
<li>轮廓发现是基于图像边缘提取的基础寻找对象轮廓的方法。</li>
<li>所以边缘提取的阈值选定会影响最终轮廓发现结果</li>
<li>API介绍<ul>
<li>findContours发现轮廓</li>
<li>drawContours绘制轮廓</li>
</ul>
</li>
</ul>
<h5 id="轮廓发现-find-contour"><a href="#轮廓发现-find-contour" class="headerlink" title="轮廓发现(find contour)"></a>轮廓发现(find contour)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在二值图像上发现轮廓使用API cv::findContours(</span><br><span class="line">InputOutputArray  binImg, // 输入图像，非0的像素被看成1,0的像素值保持不变，8-bit</span><br><span class="line">     OutputArrayOfArrays  contours,//  全部发现的轮廓对象</span><br><span class="line">    OutputArray,  hierachy// 图该的拓扑结构，可选，该轮廓发现算法正是基于图像拓扑结构实现。</span><br><span class="line">    int mode, //  轮廓返回的模式</span><br><span class="line">    int method,// 发现方法</span><br><span class="line">    Point offset=Point()//  轮廓像素的位移，默认（0, 0）没有位移</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="轮廓绘制-draw-contour"><a href="#轮廓绘制-draw-contour" class="headerlink" title="轮廓绘制(draw contour)"></a>轮廓绘制(draw contour)</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">在二值图像上发现轮廓使用API cv::findContours之后对发现的轮廓数据进行绘制显示</span><br><span class="line"><span class="built_in">drawContours</span>(</span><br><span class="line">    InputOutputArray  binImg, <span class="comment">// 输出图像</span></span><br><span class="line">     OutputArrayOfArrays  contours,<span class="comment">//  全部发现的轮廓对象</span></span><br><span class="line">    Int contourIdx<span class="comment">// 轮廓索引号</span></span><br><span class="line">    <span class="keyword">const</span> Scalar &amp; color,<span class="comment">// 绘制时候颜色</span></span><br><span class="line">    <span class="keyword">int</span>  thickness,<span class="comment">// 绘制线宽</span></span><br><span class="line">    <span class="keyword">int</span>  lineType ,<span class="comment">// 线的类型LINE_8</span></span><br><span class="line">    InputArray hierarchy,<span class="comment">// 拓扑结构图</span></span><br><span class="line">    <span class="keyword">int</span> maxlevel,<span class="comment">// 最大层数， 0只绘制当前的，1表示绘制绘制当前及其内嵌的轮廓</span></span><br><span class="line">    Point offset=<span class="built_in">Point</span>()<span class="comment">// 轮廓位移，可选</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h5><ul>
<li>输入图像转为灰度图像cvtColor</li>
<li>使用Canny进行边缘提取，得到二值图像</li>
<li>使用findContours寻找轮廓</li>
<li>使用drawContours绘制轮廓</li>
</ul>
<h5 id="示例代码-4"><a href="#示例代码-4" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="keyword">int</span> threshold_value = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">RNG rng;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line">string input_title = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string output_title = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\lab\\山羊.jfif&quot;</span>);</span><br><span class="line">	<span class="built_in">namedWindow</span>(input_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(output_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">imshow</span>(input_title, src);</span><br><span class="line">	<span class="comment">//图像灰度化</span></span><br><span class="line">	<span class="built_in">cvtColor</span>(src, src, CV_BGR2GRAY);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;control img&quot;</span>, output_title, &amp;threshold_value, threshold_max, Demo_Countours);</span><br><span class="line">	<span class="built_in">Demo_Countours</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line">	Mat canny_output;</span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	vector&lt;Vec4i&gt;hierachy;</span><br><span class="line">	<span class="comment">//图像边缘检测二值化</span></span><br><span class="line">	<span class="built_in">Canny</span>(src, canny_output, threshold_value, threshold_value * <span class="number">2</span>, <span class="number">3</span>, <span class="literal">false</span>);</span><br><span class="line">	<span class="comment">//轮廓发现</span></span><br><span class="line">	<span class="built_in">findContours</span>(canny_output, contours, hierachy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	dst = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), CV_8UC3);</span><br><span class="line">	<span class="built_in">rng</span>(<span class="number">12345</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">		<span class="comment">//轮廓绘制</span></span><br><span class="line">		<span class="built_in">drawContours</span>(dst, contours, i, color, <span class="number">2</span>, <span class="number">8</span>, hierachy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(output_title, dst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="七、凸包-Convex-Hull"><a href="#七、凸包-Convex-Hull" class="headerlink" title="七、凸包-Convex Hull"></a>七、凸包-Convex Hull</h4><h5 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h5><blockquote>
<p>什么是凸包(Convex Hull)，在一个多变形边缘或者内部任                     意两个点的连线都包含在多边形边界或者内部。</p>
</blockquote>
<h6 id="正式定义："><a href="#正式定义：" class="headerlink" title="正式定义："></a>正式定义：</h6><blockquote>
<p>包含点集合S中所有点的最小凸多边形称为凸包</p>
</blockquote>
<h5 id="2、概念介绍-Graham扫描算法"><a href="#2、概念介绍-Graham扫描算法" class="headerlink" title="2、概念介绍-Graham扫描算法"></a>2、概念介绍-Graham扫描算法</h5><ul>
<li>首先选择Y方向最低的点作为起始点p0</li>
<li>从p0开始极坐标扫描，依次添加p1….pn（排序顺序是根据极坐标的角度大小，逆时针方向）</li>
<li>对每个点pi来说，如果添加pi点到凸包中导致一个左转向（逆时针方法）则添加该点到凸包， 反之如果导致一个右转向（顺时针方向）删除该点从凸包中</li>
</ul>
<h5 id="3、API说明cv-convexHull"><a href="#3、API说明cv-convexHull" class="headerlink" title="3、API说明cv::convexHull"></a>3、API说明cv::convexHull</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">convexHull(</span><br><span class="line">    InputArray points,// 输入候选点，来自findContours</span><br><span class="line">    OutputArray hull,// 凸包</span><br><span class="line">    bool clockwise,// default true, 顺时针方向</span><br><span class="line">    bool returnPoints）// true 表示返回点个数，如果第二个参数是			vector&lt;Point&gt;则自动忽略</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="4、流程"><a href="#4、流程" class="headerlink" title="4、流程"></a>4、流程</h5><ul>
<li>首先把图像从RGB转为灰度</li>
<li>然后再转为二值图像</li>
<li>在通过发现轮廓得到候选点</li>
<li>凸包API调用</li>
<li>绘制显示。<h5 id="示例代码-5"><a href="#示例代码-5" class="headerlink" title="示例代码"></a>示例代码</h5></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src,gray_src, dst;</span><br><span class="line"><span class="keyword">int</span> threshold_value = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">RNG rng;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line">string input_title = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string output_title = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\lab\\test2.png&quot;</span>);</span><br><span class="line">	<span class="built_in">namedWindow</span>(input_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(output_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">imshow</span>(input_title, src);</span><br><span class="line">	<span class="comment">//图像灰度化</span></span><br><span class="line">	<span class="built_in">cvtColor</span>(src, gray_src, CV_BGR2GRAY);</span><br><span class="line">	<span class="comment">//模糊</span></span><br><span class="line">	<span class="built_in">blur</span>(gray_src, gray_src, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>), BORDER_DEFAULT);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;control img&quot;</span>, output_title, &amp;threshold_value, threshold_max, Demo_Countours);</span><br><span class="line">	<span class="built_in">Demo_Countours</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line">	Mat bin_output;</span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	vector&lt;Vec4i&gt;hierachy;</span><br><span class="line">	<span class="comment">//设置阈值，阈值二值化</span></span><br><span class="line">	<span class="built_in">threshold</span>(gray_src, bin_output, threshold_value, threshold_max, THRESH_BINARY);</span><br><span class="line">	<span class="comment">//发现轮廓</span></span><br><span class="line">	<span class="built_in">findContours</span>(bin_output, contours, hierachy, RETR_EXTERNAL, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; <span class="built_in">convexs</span>(contours.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">convexHull</span>(contours[i], convexs[i], <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//绘制</span></span><br><span class="line">	dst = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), CV_8UC3);</span><br><span class="line">	vector&lt;Vec4i&gt;<span class="built_in">empty</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">		<span class="built_in">drawContours</span>(dst, contours, i, color,<span class="number">2</span>, LINE_8, hierachy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">		<span class="built_in">drawContours</span>(dst, convexs, i, color, <span class="number">2</span>, LINE_8, empty, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(output_title, dst);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="八、轮廓周围绘制矩形框和圆形框"><a href="#八、轮廓周围绘制矩形框和圆形框" class="headerlink" title="八、轮廓周围绘制矩形框和圆形框"></a>八、轮廓周围绘制矩形框和圆形框</h4><h5 id="1、轮廓周围绘制矩形-API"><a href="#1、轮廓周围绘制矩形-API" class="headerlink" title="1、轮廓周围绘制矩形 -API"></a>1、轮廓周围绘制矩形 -API</h5><ul>
<li>approxPolyDP(InputArray  curve, OutputArray approxCurve,  double  epsilon,  bool  closed)</li>
<li>cv::boundingRect(InputArray points)得到轮廓周围最小矩形左上交点坐标和右下角点坐标，绘制一个矩形</li>
<li>cv::minAreaRect(InputArray  points)得到一个旋转的矩形，返回旋转矩形</li>
</ul>
<h5 id="2、轮廓周围绘制圆和椭圆-API"><a href="#2、轮廓周围绘制圆和椭圆-API" class="headerlink" title="2、轮廓周围绘制圆和椭圆-API"></a>2、轮廓周围绘制圆和椭圆-API</h5><ul>
<li>cv::minEnclosingCircle(InputArray points, //得到最小区域圆形<ul>
<li>Point2f&amp; center, // 圆心位置</li>
<li>float&amp; radius)// 圆的半径</li>
</ul>
</li>
<li>cv::fitEllipse(InputArray  points)得到最小椭圆</li>
</ul>
<h5 id="3、流程"><a href="#3、流程" class="headerlink" title="3、流程"></a>3、流程</h5><ul>
<li>首先将图像变为二值图像</li>
<li>发现轮廓，找到图像轮廓</li>
<li>通过相关API在轮廓点上找到最小包含矩形和圆，旋转矩形与椭圆。</li>
<li>绘制它们。<h5 id="示例代码-6"><a href="#示例代码-6" class="headerlink" title="示例代码"></a>示例代码</h5></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, gray_src, drawImg;</span><br><span class="line"><span class="keyword">int</span> threshold_v = <span class="number">170</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* output_win = <span class="string">&quot;rectangle-demo&quot;</span>;</span><br><span class="line"><span class="function">RNG <span class="title">rng</span><span class="params">(<span class="number">12345</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Contours_Callback</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\15646\\Pictures\\lab\\热气球.jfif&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;could not load image...\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cvtColor</span>(src, gray_src, CV_BGR2GRAY);</span><br><span class="line">	<span class="built_in">blur</span>(gray_src, gray_src, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* source_win = <span class="string">&quot;input image&quot;</span>;</span><br><span class="line">	<span class="built_in">namedWindow</span>(source_win, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(output_win, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">imshow</span>(source_win, src);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;Threshold Value:&quot;</span>, output_win, &amp;threshold_v, threshold_max, Contours_Callback);</span><br><span class="line">	<span class="built_in">Contours_Callback</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Contours_Callback</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line">	Mat binary_output;</span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	vector&lt;Vec4i&gt; hierachy;</span><br><span class="line">	<span class="built_in">threshold</span>(gray_src, binary_output, threshold_v, threshold_max, THRESH_BINARY);</span><br><span class="line">	<span class="comment">//imshow(&quot;binary image&quot;, binary_output);</span></span><br><span class="line">	<span class="built_in">findContours</span>(binary_output, contours, hierachy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"></span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; <span class="built_in">contours_ploy</span>(contours.<span class="built_in">size</span>());</span><br><span class="line">	<span class="function">vector&lt;Rect&gt; <span class="title">ploy_rects</span><span class="params">(contours.size())</span></span>;</span><br><span class="line">	<span class="function">vector&lt;Point2f&gt; <span class="title">ccs</span><span class="params">(contours.size())</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="keyword">float</span>&gt; <span class="title">radius</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;RotatedRect&gt; <span class="title">minRects</span><span class="params">(contours.size())</span></span>;</span><br><span class="line">	<span class="function">vector&lt;RotatedRect&gt; <span class="title">myellipse</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">		<span class="built_in">approxPolyDP</span>(<span class="built_in">Mat</span>(contours[i]), contours_ploy[i], <span class="number">3</span>, <span class="literal">true</span>);</span><br><span class="line">		ploy_rects[i] = <span class="built_in">boundingRect</span>(contours_ploy[i]);</span><br><span class="line">		<span class="built_in">minEnclosingCircle</span>(contours_ploy[i], ccs[i], radius[i]);</span><br><span class="line">		<span class="keyword">if</span> (contours_ploy[i].<span class="built_in">size</span>() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">			myellipse[i] = <span class="built_in">fitEllipse</span>(contours_ploy[i]);</span><br><span class="line">			minRects[i] = <span class="built_in">minAreaRect</span>(contours_ploy[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// draw it</span></span><br><span class="line">	drawImg = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), src.<span class="built_in">type</span>());</span><br><span class="line">	Point2f pts[<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> t = <span class="number">0</span>; t &lt; contours.<span class="built_in">size</span>(); t++) &#123;</span><br><span class="line">		Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">		<span class="comment">//rectangle(drawImg, ploy_rects[t], color, 2, 8);</span></span><br><span class="line">		<span class="comment">//circle(drawImg, ccs[t], radius[t], color, 2, 8);</span></span><br><span class="line">		<span class="keyword">if</span> (contours_ploy[t].<span class="built_in">size</span>() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">			<span class="built_in">ellipse</span>(drawImg, myellipse[t], color, <span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line">			minRects[t].<span class="built_in">points</span>(pts);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">				<span class="built_in">line</span>(drawImg, pts[r], pts[(r + <span class="number">1</span>) % <span class="number">4</span>], color, <span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(output_win, drawImg);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="九、图像矩-Image-Moments"><a href="#九、图像矩-Image-Moments" class="headerlink" title="九、图像矩(Image Moments)"></a>九、图像矩(Image Moments)</h4><h5 id="1、概念"><a href="#1、概念" class="headerlink" title="1、概念"></a>1、概念</h5><p><img src="http://myfile.buildworld.cn/%E5%87%A0%E4%BD%95%E7%9F%A9.jpg" alt="image"></p>
<h5 id="2、图像中心Center-x0-y0"><a href="#2、图像中心Center-x0-y0" class="headerlink" title="2、图像中心Center(x0, y0)"></a>2、图像中心Center(x0, y0)</h5><html>
<a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{200}&space;\large&space;x_{0}=\frac{m_{10}}{m_{00}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;x_{0}=\frac{m_{10}}{m_{00}}" title="\large x_{0}=\frac{m_{10}}{m_{00}}" /></a>
</html>

<html>
<a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{200}&space;\large&space;y_{0}=\frac{m_{01}}{m_{00}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;y_{0}=\frac{m_{01}}{m_{00}}" title="\large y_{0}=\frac{m_{01}}{m_{00}}" /></a>
</html>


<h5 id="3、API介绍与使用-计算矩cv-moments"><a href="#3、API介绍与使用-计算矩cv-moments" class="headerlink" title="3、API介绍与使用-计算矩cv::moments"></a>3、API介绍与使用-计算矩cv::moments</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">moments(</span><br><span class="line">InputArray  array,//输入数据</span><br><span class="line">bool   binaryImage=false // 是否为二值图像</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">contourArea(</span><br><span class="line">InputArray  contour,//输入轮廓数据</span><br><span class="line">bool   oriented// 默认false、返回绝对值)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">arcLength(</span><br><span class="line">InputArray  curve,//输入曲线数据</span><br><span class="line">bool   closed// 是否是封闭曲线)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h5 id="4、过程"><a href="#4、过程" class="headerlink" title="4、过程"></a>4、过程</h5><ul>
<li>提取图像边缘</li>
<li>发现轮廓</li>
<li>计算每个轮廓对象的矩</li>
<li>计算每个对象的中心、弧长、面积</li>
</ul>
<h5 id="示例代码-7"><a href="#示例代码-7" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst,gray_src;</span><br><span class="line"><span class="keyword">int</span> threshold_value = <span class="number">80</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">RNG rng;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span></span>;</span><br><span class="line">string input_title = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string output_title = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\Administrator\\Pictures\\lab\\星球.jpg&quot;</span>);</span><br><span class="line">	<span class="built_in">namedWindow</span>(input_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(output_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">imshow</span>(input_title, src);</span><br><span class="line">	<span class="comment">//图像灰度化</span></span><br><span class="line">	<span class="built_in">cvtColor</span>(src, gray_src, CV_BGR2GRAY);</span><br><span class="line">	<span class="comment">//高斯模糊</span></span><br><span class="line">	<span class="built_in">GaussianBlur</span>(gray_src, gray_src, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">createTrackbar</span>(<span class="string">&quot;control img&quot;</span>, output_title, &amp;threshold_value, threshold_max, Demo_Countours);</span><br><span class="line">	<span class="built_in">Demo_Countours</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo_Countours</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">void</span>*)</span> </span>&#123;</span><br><span class="line">	Mat canny_out;</span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	vector&lt;Vec4i&gt;hierachy; </span><br><span class="line"></span><br><span class="line">	<span class="comment">//边缘检测</span></span><br><span class="line">	<span class="built_in">Canny</span>(gray_src, canny_out, threshold_value, threshold_value * <span class="number">2</span>,<span class="number">3</span>, <span class="literal">false</span>);</span><br><span class="line">	<span class="comment">//轮廓发现</span></span><br><span class="line">	<span class="built_in">findContours</span>(canny_out, contours, hierachy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;Moments&gt; <span class="title">contours_moments</span><span class="params">(contours.size())</span></span>;</span><br><span class="line">	<span class="function">vector&lt;Point2f&gt; <span class="title">ccs</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//计算矩</span></span><br><span class="line">		contours_moments[i] = <span class="built_in">moments</span>(contours[i]);</span><br><span class="line">		<span class="comment">//计算图像中心，获取中心坐标</span></span><br><span class="line">		ccs[i] = <span class="built_in">Point</span>(<span class="keyword">static_cast</span>&lt;<span class="keyword">float</span>&gt;(contours_moments[i].m10 / contours_moments[i].m00), <span class="keyword">static_cast</span>&lt;<span class="keyword">float</span>&gt;(contours_moments[i].m01 / contours_moments[i].m00));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Mat drawImg;</span><br><span class="line">	src.<span class="built_in">copyTo</span>(drawImg);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (contours[i].<span class="built_in">size</span>()&lt;<span class="number">30</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//打印面积和长度</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;contours %d  area :%.2f and length :%.2f \n&quot;</span>, i, <span class="built_in">contourArea</span>(contours[i]), <span class="built_in">arcLength</span>(contours[i], <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//随机颜色</span></span><br><span class="line">		Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">		<span class="comment">//轮廓绘制</span></span><br><span class="line">		<span class="built_in">drawContours</span>(drawImg, contours, i, color, <span class="number">2</span>, <span class="number">8</span>, hierachy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">		<span class="comment">//画圆</span></span><br><span class="line">		<span class="built_in">circle</span>(drawImg, ccs[i], <span class="number">2</span>, color, <span class="number">2</span>, <span class="number">8</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(output_title, drawImg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="十、点多边形测试"><a href="#十、点多边形测试" class="headerlink" title="十、点多边形测试"></a>十、点多边形测试</h4><h5 id="1、概念-1"><a href="#1、概念-1" class="headerlink" title="1、概念"></a>1、概念</h5><blockquote>
<p>测试一个点是否在给定的多边形内部，边缘或者外部</p>
</blockquote>
<h5 id="2、API介绍-cv-pointPolygonTest"><a href="#2、API介绍-cv-pointPolygonTest" class="headerlink" title="2、API介绍 cv::pointPolygonTest"></a>2、API介绍 cv::pointPolygonTest</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pointPolygonTest</span>(</span><br><span class="line">InputArray  contour,<span class="comment">// 输入的轮廓</span></span><br><span class="line">Point2f  pt, <span class="comment">// 测试点</span></span><br><span class="line"><span class="keyword">bool</span>  measureDist <span class="comment">// 是否返回距离值，如果是false，1表示在内面，0表示在边界上，-1表示在外部，true返回实际距离</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">返回数据是<span class="keyword">double</span>类型</span><br></pre></td></tr></table></figure>
<h5 id="3、步骤"><a href="#3、步骤" class="headerlink" title="3、步骤"></a>3、步骤</h5><ul>
<li>构建一张400x400大小的图片， Mat::Zero(400, 400, CV_8UC1)</li>
<li>画上一个六边形的闭合区域line</li>
<li>发现轮廓</li>
<li>对图像中所有像素点做点 多边形测试，得到距离，归一化后显示。</li>
</ul>
<h5 id="示例代码-8"><a href="#示例代码-8" class="headerlink" title="示例代码"></a>示例代码</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst,gray_src;</span><br><span class="line"><span class="keyword">int</span> threshold_value = <span class="number">80</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">RNG rng;</span><br><span class="line">string input_title = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string output_title = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> r = <span class="number">100</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	src = Mat::<span class="built_in">zeros</span>(r * <span class="number">4</span>, r * <span class="number">4</span>, CV_8UC1);</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;Point2f&gt; <span class="title">vert</span><span class="params">(<span class="number">6</span>)</span></span>;</span><br><span class="line">	vert[<span class="number">0</span>] = <span class="built_in">Point</span>(<span class="number">3</span> * r / <span class="number">2</span>, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">1.34</span>*r));</span><br><span class="line">	vert[<span class="number">1</span>] = <span class="built_in">Point</span>(<span class="number">1</span> * r, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">2</span> * r));</span><br><span class="line">	vert[<span class="number">2</span>] = <span class="built_in">Point</span>(<span class="number">3</span> * r / <span class="number">2</span>, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">2.886</span>*r));</span><br><span class="line">	vert[<span class="number">3</span>] = <span class="built_in">Point</span>(<span class="number">5</span> * r / <span class="number">2</span>, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">2.886</span>*r));</span><br><span class="line">	vert[<span class="number">4</span>] = <span class="built_in">Point</span>(<span class="number">3</span> * r, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">2</span> * r));</span><br><span class="line">	vert[<span class="number">5</span>] = <span class="built_in">Point</span>(<span class="number">5</span> * r / <span class="number">2</span>, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">1.34</span>*r));</span><br><span class="line"></span><br><span class="line">	<span class="comment">//画多边形</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">line</span>(src, vert[i], vert[(i + <span class="number">1</span>) % <span class="number">6</span>], <span class="built_in">Scalar</span>(<span class="number">255</span>), <span class="number">8</span>, LINE_8, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	vector&lt;Vec4i&gt; hierachy;</span><br><span class="line">	Mat csrc;</span><br><span class="line">	src.<span class="built_in">copyTo</span>(csrc);</span><br><span class="line">	<span class="comment">//轮廓发现</span></span><br><span class="line">	<span class="built_in">findContours</span>(csrc, contours, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	Mat raw_dist = Mat::<span class="built_in">zeros</span>(csrc.<span class="built_in">size</span>(), CV_32FC1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; raw_dist.rows; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; raw_dist.cols; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//点多边形测试</span></span><br><span class="line">			<span class="keyword">double</span> dist = <span class="built_in">pointPolygonTest</span>(contours[<span class="number">0</span>], <span class="built_in">Point2f</span>(<span class="keyword">static_cast</span>&lt;<span class="keyword">float</span>&gt;(col), <span class="keyword">static_cast</span>&lt;<span class="keyword">float</span>&gt;(row)), <span class="literal">true</span>);</span><br><span class="line">			raw_dist.at&lt;<span class="keyword">float</span>&gt;(row, col) = <span class="keyword">static_cast</span>&lt;<span class="keyword">float</span>&gt;(dist);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> minValue, maxValue;</span><br><span class="line">	<span class="comment">//归一化处理</span></span><br><span class="line">	<span class="built_in">minMaxLoc</span>(raw_dist, &amp;minValue, &amp;maxValue, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	Mat drawImg = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), CV_8UC3);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; drawImg.rows; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; drawImg.cols; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">float</span> dist = raw_dist.at&lt;<span class="keyword">float</span>&gt;(row, col);</span><br><span class="line">			<span class="keyword">if</span> (dist &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				drawImg.at&lt;Vec3b&gt;(row, col)[<span class="number">0</span>] = (uchar)(<span class="built_in">abs</span>(<span class="number">1.0</span> - (dist / maxValue)) * <span class="number">255</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (dist &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				drawImg.at&lt;Vec3b&gt;(row, col)[<span class="number">2</span>] = (uchar)(<span class="built_in">abs</span>(<span class="number">1.0</span>- (dist / maxValue)) * <span class="number">255</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				drawImg.at&lt;Vec3b&gt;(row, col)[<span class="number">0</span>] = (uchar)(<span class="built_in">abs</span>(<span class="number">255</span> - dist));</span><br><span class="line">				drawImg.at&lt;Vec3b&gt;(row, col)[<span class="number">1</span>] = (uchar)(<span class="built_in">abs</span>(<span class="number">255</span> - dist));</span><br><span class="line">				drawImg.at&lt;Vec3b&gt;(row, col)[<span class="number">2</span>] = (uchar)(<span class="built_in">abs</span>(<span class="number">255</span> - dist));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">		<span class="built_in">namedWindow</span>(input_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">		<span class="built_in">namedWindow</span>(output_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">		<span class="built_in">imshow</span>(input_title, src);</span><br><span class="line">		<span class="built_in">imshow</span>(output_title, drawImg);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="十一、基于距离变换与分水岭的图像分割"><a href="#十一、基于距离变换与分水岭的图像分割" class="headerlink" title="十一、基于距离变换与分水岭的图像分割"></a>十一、基于距离变换与分水岭的图像分割</h4><h5 id="1、概念-2"><a href="#1、概念-2" class="headerlink" title="1、概念"></a>1、概念</h5><ul>
<li>图像分割(Image Segmentation)是图像处理最重要的处理手段之一</li>
<li>图像分割的目标是将图像中像素根据一定的规则分为若干(N)个cluster集合，每个集合包含一类像素。</li>
<li>根据算法分为监督学习方法和无监督学习方法，图像分割的算法多数都是无监督学习方法 - KMeans</li>
</ul>
<h5 id="2、距离变换与分水岭介绍"><a href="#2、距离变换与分水岭介绍" class="headerlink" title="2、距离变换与分水岭介绍"></a>2、距离变换与分水岭介绍</h5><ul>
<li>距离变换常见算法有两种<ul>
<li>不断膨胀/ 腐蚀得到</li>
<li>基于倒角距离</li>
</ul>
</li>
<li>分水岭变换常见的算法<ul>
<li>基于浸泡理论实现 </li>
</ul>
</li>
</ul>
<h5 id="3、相关API-1"><a href="#3、相关API-1" class="headerlink" title="3、相关API"></a>3、相关API</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cv::<span class="built_in">distanceTransform</span>(InputArray  src, OutputArray dst,  OutputArray  labels,  <span class="keyword">int</span>  distanceType,  <span class="keyword">int</span> maskSize,  <span class="keyword">int</span> labelType=DIST_LABEL_CCOMP)</span><br><span class="line">        distanceType = DIST_L1/DIST_L2,</span><br><span class="line">        maskSize = <span class="number">3</span>x3,最新的支持<span class="number">5</span>x5，推荐<span class="number">3</span>x3、</span><br><span class="line">        labels离散维诺图输出</span><br><span class="line">        dst输出<span class="number">8</span>位或者<span class="number">32</span>位的浮点数，单一通道，大小与输入图像一致</span><br><span class="line"></span><br><span class="line">cv::<span class="built_in">watershed</span>(InputArray image, InputOutputArray  markers)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="4、流程-1"><a href="#4、流程-1" class="headerlink" title="4、流程"></a>4、流程</h5><ul>
<li><ol>
<li>将白色背景变成黑色-目的是为后面的变换做准备</li>
</ol>
</li>
<li><ol start="2">
<li>使用filter2D与拉普拉斯算子实现图像对比度提高，sharp</li>
</ol>
</li>
<li><ol start="3">
<li>转为二值图像通过threshold</li>
</ol>
</li>
<li><ol start="4">
<li>距离变换</li>
</ol>
</li>
<li><ol start="5">
<li>对距离变换结果进行归一化到[0~1]之间</li>
</ol>
</li>
<li><ol start="6">
<li>使用阈值，再次二值化，得到标记</li>
</ol>
</li>
<li><ol start="7">
<li>腐蚀得到每个Peak - erode</li>
</ol>
</li>
<li><ol start="8">
<li>发现轮廓 – findContours</li>
</ol>
</li>
<li><ol start="9">
<li>绘制轮廓- drawContours</li>
</ol>
</li>
<li><ol start="10">
<li>分水岭变换 watershed</li>
</ol>
</li>
<li><ol start="11">
<li>对每个分割区域着色输出结果</li>
</ol>
</li>
<li><h5 id="示例代码-9"><a href="#示例代码-9" class="headerlink" title="示例代码"></a>示例代码</h5></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="keyword">int</span> threshold_value = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">RNG rng;</span><br><span class="line">string input_title = <span class="string">&quot;input img&quot;</span>;</span><br><span class="line">string output_title = <span class="string">&quot;output img&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv)</span> </span>&#123;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;C:\\Users\\Administrator\\Pictures\\lab\\红桃.png&quot;</span>);</span><br><span class="line">	<span class="built_in">namedWindow</span>(input_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	<span class="built_in">namedWindow</span>(output_title, CV_WINDOW_AUTOSIZE);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//修改背景颜色</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; src.rows; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; src.cols; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (src.at&lt;Vec3b&gt;(row,col) == <span class="built_in">Vec3b</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				src.at&lt;Vec3b&gt;(row, col)[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">				src.at&lt;Vec3b&gt;(row, col)[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">				src.at&lt;Vec3b&gt;(row, col)[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//膨胀（去除小黑点，噪点）</span></span><br><span class="line">	Mat structureElement = <span class="built_in">getStructuringElement</span>(MORPH_RECT, <span class="built_in">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line">	<span class="built_in">dilate</span>(src, src, structureElement, <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>), <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//锐化图像，shape</span></span><br><span class="line">	Mat kernel = (Mat_&lt;<span class="keyword">float</span>&gt;(<span class="number">3</span>, <span class="number">3</span>) &lt;&lt; <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">	Mat imgLaplance;</span><br><span class="line">	Mat shapenImg = src;</span><br><span class="line">	<span class="built_in">filter2D</span>(src, imgLaplance, CV_32F, kernel, <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>), <span class="number">0</span>, BORDER_DEFAULT);</span><br><span class="line">	src.<span class="built_in">convertTo</span>(shapenImg, CV_32F);</span><br><span class="line">	Mat resultImg = shapenImg - imgLaplance;</span><br><span class="line">	resultImg.<span class="built_in">convertTo</span>(resultImg, CV_8UC3);</span><br><span class="line">	imgLaplance.<span class="built_in">convertTo</span>(imgLaplance, CV_8UC3);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//二值图像convert to binary</span></span><br><span class="line">	Mat binaryImg;</span><br><span class="line">	<span class="built_in">cvtColor</span>(resultImg, resultImg, CV_BGR2GRAY);</span><br><span class="line">	<span class="built_in">threshold</span>(resultImg, binaryImg, <span class="number">40</span>, <span class="number">255</span>, CV_THRESH_BINARY | THRESH_OTSU);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//距离变化</span></span><br><span class="line">	Mat distImg;</span><br><span class="line">	<span class="built_in">distanceTransform</span>(binaryImg, distImg, DIST_L1, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">	<span class="built_in">normalize</span>(distImg, distImg, <span class="number">0</span>, <span class="number">1</span>, NORM_MINMAX);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//距离变化之后再次二值化图像</span></span><br><span class="line">	<span class="built_in">threshold</span>(distImg, distImg, <span class="number">0.4</span>, <span class="number">1</span>, THRESH_BINARY);</span><br><span class="line">	Mat kernel1 = Mat::<span class="built_in">zeros</span>(<span class="number">13</span>, <span class="number">13</span>, CV_8UC1);</span><br><span class="line">	<span class="comment">//腐蚀</span></span><br><span class="line">	<span class="built_in">erode</span>(distImg, distImg, kernel1);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//markers标记</span></span><br><span class="line">	Mat dist_8u;</span><br><span class="line">	distImg.<span class="built_in">convertTo</span>(dist_8u, CV_8U);</span><br><span class="line">	vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">	<span class="built_in">findContours</span>(dist_8u, contours, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	<span class="comment">//create makers</span></span><br><span class="line">	Mat markers = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), CV_32SC1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">drawContours</span>(markers, contours, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(i), Scalar::<span class="built_in">all</span> (<span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(i) + <span class="number">1</span>),<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">circle</span>(markers, <span class="built_in">Point</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="number">3</span>, <span class="built_in">Scalar</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>), <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//分水岭</span></span><br><span class="line">	<span class="built_in">watershed</span>(src, markers);</span><br><span class="line">	Mat res = Mat::<span class="built_in">zeros</span>(markers.<span class="built_in">size</span>(), CV_8UC1);</span><br><span class="line">	markers.<span class="built_in">convertTo</span>(res, CV_8UC1);</span><br><span class="line">	<span class="built_in">bitwise_not</span>(res, res, <span class="built_in">Mat</span>());</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生成随机颜色</span></span><br><span class="line">	vector&lt;Vec3b&gt; colors;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> r = rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">		<span class="keyword">int</span> g = rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">		<span class="keyword">int</span> b = rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">		colors.<span class="built_in">push_back</span>(<span class="built_in">Vec3b</span>((uchar)b, (uchar)g, (uchar)r));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//填满颜色</span></span><br><span class="line">	dst = Mat::<span class="built_in">zeros</span>(markers.<span class="built_in">size</span>(), CV_8UC3);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; src.rows; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; src.cols; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> index = markers.at&lt;<span class="keyword">int</span>&gt;(row, col);</span><br><span class="line">			<span class="keyword">if</span> (index&gt;<span class="number">0</span> &amp;&amp; index&lt;=<span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(contours.<span class="built_in">size</span>()))</span><br><span class="line">			&#123;</span><br><span class="line">				dst.at&lt;Vec3b&gt;(row, col) = colors[index - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				dst.at&lt;Vec3b&gt;(row, col) = <span class="built_in">Vec3b</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">imshow</span>(input_title, src);</span><br><span class="line">	<span class="built_in">imshow</span>(output_title, dst);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:qjzxzxd@gmail.com">MiChong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.buildworld.cn/2019/07/22/OpenCV%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E3%80%81%E8%BD%AE%E5%BB%93%E7%AD%89%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/">https://www.buildworld.cn/2019/07/22/OpenCV%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E9%9C%8D%E5%A4%AB%E5%8F%98%E6%8D%A2%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E3%80%81%E8%BD%AE%E5%BB%93%E7%AD%89%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.buildworld.cn" target="_blank">MiChong的🏡</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/OpenCV/">OpenCV</a></div><div class="post_share"><div class="social-share" data-image="https://file.buildworld.cn/img/opencv.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/19/Python%E5%BC%80%E5%8F%91%E4%B9%8Bnumpy%E7%9A%84%E4%BD%BF%E7%94%A8/"><img class="prev-cover" src="https://file.buildworld.cn/img/36e3eb10ca35c9673229fd526e7e7697_5ac6e9d90002903efacacdcb8182b8ed.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python开发之numpy的使用</div></div></a></div><div class="next-post pull-right"><a href="/2019/07/11/OpenCV%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%9B%BE%E7%89%87%E6%93%8D%E4%BD%9C%E8%BF%9B%E9%98%B6/"><img class="next-cover" src="https://file.buildworld.cn/img/opencv.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">OpenCV图像处理笔记（二）：图片操作进阶</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/07/08/OpenCV图像处理笔记（一）：图片基本操作/" title="OpenCV图像处理笔记（一）：图片基本操作"><img class="cover" src="https://file.buildworld.cn/img/opencv.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-07-08</div><div class="title">OpenCV图像处理笔记（一）：图片基本操作</div></div></a></div><div><a href="/2019/07/11/OpenCV图像处理笔记（二）：图片操作进阶/" title="OpenCV图像处理笔记（二）：图片操作进阶"><img class="cover" src="https://file.buildworld.cn/img/opencv.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-07-11</div><div class="title">OpenCV图像处理笔记（二）：图片操作进阶</div></div></a></div><div><a href="/2020/03/05/Python版本的OpenCV安装/" title="Python版本的OpenCV安装"><img class="cover" src="https://file.buildworld.cn/img/opencv.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-05</div><div class="title">Python版本的OpenCV安装</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/header.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">MiChong</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">71</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">69</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/MiChongGET"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/qjzxzxd@gmail.com" target="_blank" title=""><i class="fa fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到米虫的小站，一起加油🤝</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%9C%8D%E5%A4%AB%E7%9B%B4%E7%BA%BF%E5%8F%98%E6%8D%A2"><span class="toc-number">1.</span> <span class="toc-text">一、霍夫直线变换</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E9%9C%8D%E5%A4%AB%E7%9B%B4%E7%BA%BF%E5%8F%98%E6%8D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">1、霍夫直线变换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E9%9C%8D%E5%A4%AB%E7%9B%B4%E7%BA%BF%E5%8F%98%E6%8D%A2%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.</span> <span class="toc-text">2、霍夫直线变换介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%9B%B8%E5%85%B3API"><span class="toc-number">1.3.</span> <span class="toc-text">3、相关API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.4.</span> <span class="toc-text">实例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%9C%8D%E5%A4%AB%E5%9C%86%E6%A3%80%E6%B5%8B"><span class="toc-number">2.</span> <span class="toc-text">二、霍夫圆检测</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">1、原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E7%9B%B8%E5%85%B3API-cv-HoughCircles"><span class="toc-number">2.2.</span> <span class="toc-text">2、相关API cv::HoughCircles</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%83%8F%E7%B4%A0%E9%87%8D%E6%98%A0%E5%B0%84"><span class="toc-number">3.</span> <span class="toc-text">三、像素重映射</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%8E%9F%E7%90%86-1"><span class="toc-number">3.1.</span> <span class="toc-text">1、原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81API%E4%BB%8B%E7%BB%8Dcv-remap"><span class="toc-number">3.2.</span> <span class="toc-text">2、API介绍cv::remap</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-1"><span class="toc-number">3.3.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE-histogram"><span class="toc-number">4.</span> <span class="toc-text">四、直方图 (histogram)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%9D%87%E8%A1%A1%E5%8C%96%E6%A6%82%E5%BF%B5"><span class="toc-number">4.1.</span> <span class="toc-text">1、直方图均衡化概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%9D%87%E8%A1%A1%E5%8C%96"><span class="toc-number">4.2.</span> <span class="toc-text">2、直方图均衡化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%9D%87%E8%A1%A1%E5%8C%96API%E8%AF%B4%E6%98%8Ecv-equalizeHist"><span class="toc-number">4.3.</span> <span class="toc-text">3、直方图均衡化API说明cv::equalizeHist</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E8%AE%A1%E7%AE%97"><span class="toc-number">4.4.</span> <span class="toc-text">4、直方图计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E6%AF%94%E8%BE%83%E6%96%B9%E6%B3%95-%E6%A6%82%E8%BF%B0"><span class="toc-number">4.5.</span> <span class="toc-text">4、直方图比较方法-概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3API"><span class="toc-number">4.6.</span> <span class="toc-text">相关API</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3API-cv-compareHist"><span class="toc-number">4.6.1.</span> <span class="toc-text">相关API cv::compareHist</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-2"><span class="toc-number">4.6.2.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E7%9B%B4%E6%96%B9%E5%9B%BE%E5%8F%8D%E5%90%91%E6%8A%95%E5%BD%B1-Back-Projection"><span class="toc-number">4.7.</span> <span class="toc-text">5、直方图反向投影(Back Projection)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E6%8A%95%E5%BD%B1-%E2%80%93-%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.7.1.</span> <span class="toc-text">反向投影 – 步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D-Template-Match"><span class="toc-number">5.</span> <span class="toc-text">五、模板匹配(Template Match)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.1.</span> <span class="toc-text">1、模板匹配介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%A8%A1%E6%9D%BF%E5%8C%B9%E9%85%8D%E4%BB%8B%E7%BB%8D-%E2%80%93-%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.2.</span> <span class="toc-text">2、模板匹配介绍 – 匹配算法介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%9B%B8%E5%85%B3API%E4%BB%8B%E7%BB%8Dcv-matchTemplate"><span class="toc-number">5.3.</span> <span class="toc-text">3、相关API介绍cv::matchTemplate</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-3"><span class="toc-number">5.4.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E8%BD%AE%E5%BB%93%E5%8F%91%E7%8E%B0-find-contour-in-your-image"><span class="toc-number">6.</span> <span class="toc-text">六、轮廓发现(find contour in your image)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AE%E5%BB%93%E5%8F%91%E7%8E%B0-find-contour"><span class="toc-number">6.1.</span> <span class="toc-text">轮廓发现(find contour)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AE%E5%BB%93%E7%BB%98%E5%88%B6-draw-contour"><span class="toc-number">6.2.</span> <span class="toc-text">轮廓绘制(draw contour)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B"><span class="toc-number">6.3.</span> <span class="toc-text">流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-4"><span class="toc-number">6.4.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%87%B8%E5%8C%85-Convex-Hull"><span class="toc-number">7.</span> <span class="toc-text">七、凸包-Convex Hull</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%9A%E4%B9%89"><span class="toc-number">7.1.</span> <span class="toc-text">1、定义</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%AD%A3%E5%BC%8F%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="toc-number">7.1.1.</span> <span class="toc-text">正式定义：</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D-Graham%E6%89%AB%E6%8F%8F%E7%AE%97%E6%B3%95"><span class="toc-number">7.2.</span> <span class="toc-text">2、概念介绍-Graham扫描算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81API%E8%AF%B4%E6%98%8Ecv-convexHull"><span class="toc-number">7.3.</span> <span class="toc-text">3、API说明cv::convexHull</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B5%81%E7%A8%8B"><span class="toc-number">7.4.</span> <span class="toc-text">4、流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-5"><span class="toc-number">7.5.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%BD%AE%E5%BB%93%E5%91%A8%E5%9B%B4%E7%BB%98%E5%88%B6%E7%9F%A9%E5%BD%A2%E6%A1%86%E5%92%8C%E5%9C%86%E5%BD%A2%E6%A1%86"><span class="toc-number">8.</span> <span class="toc-text">八、轮廓周围绘制矩形框和圆形框</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E8%BD%AE%E5%BB%93%E5%91%A8%E5%9B%B4%E7%BB%98%E5%88%B6%E7%9F%A9%E5%BD%A2-API"><span class="toc-number">8.1.</span> <span class="toc-text">1、轮廓周围绘制矩形 -API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%BD%AE%E5%BB%93%E5%91%A8%E5%9B%B4%E7%BB%98%E5%88%B6%E5%9C%86%E5%92%8C%E6%A4%AD%E5%9C%86-API"><span class="toc-number">8.2.</span> <span class="toc-text">2、轮廓周围绘制圆和椭圆-API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%B5%81%E7%A8%8B"><span class="toc-number">8.3.</span> <span class="toc-text">3、流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-6"><span class="toc-number">8.4.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%9B%BE%E5%83%8F%E7%9F%A9-Image-Moments"><span class="toc-number">9.</span> <span class="toc-text">九、图像矩(Image Moments)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E5%BF%B5"><span class="toc-number">9.1.</span> <span class="toc-text">1、概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%9B%BE%E5%83%8F%E4%B8%AD%E5%BF%83Center-x0-y0"><span class="toc-number">9.2.</span> <span class="toc-text">2、图像中心Center(x0, y0)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81API%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8-%E8%AE%A1%E7%AE%97%E7%9F%A9cv-moments"><span class="toc-number">9.3.</span> <span class="toc-text">3、API介绍与使用-计算矩cv::moments</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E8%BF%87%E7%A8%8B"><span class="toc-number">9.4.</span> <span class="toc-text">4、过程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-7"><span class="toc-number">9.5.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E7%82%B9%E5%A4%9A%E8%BE%B9%E5%BD%A2%E6%B5%8B%E8%AF%95"><span class="toc-number">10.</span> <span class="toc-text">十、点多边形测试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E5%BF%B5-1"><span class="toc-number">10.1.</span> <span class="toc-text">1、概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81API%E4%BB%8B%E7%BB%8D-cv-pointPolygonTest"><span class="toc-number">10.2.</span> <span class="toc-text">2、API介绍 cv::pointPolygonTest</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%AD%A5%E9%AA%A4"><span class="toc-number">10.3.</span> <span class="toc-text">3、步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-8"><span class="toc-number">10.4.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%9F%BA%E4%BA%8E%E8%B7%9D%E7%A6%BB%E5%8F%98%E6%8D%A2%E4%B8%8E%E5%88%86%E6%B0%B4%E5%B2%AD%E7%9A%84%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2"><span class="toc-number">11.</span> <span class="toc-text">十一、基于距离变换与分水岭的图像分割</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E5%BF%B5-2"><span class="toc-number">11.1.</span> <span class="toc-text">1、概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%B7%9D%E7%A6%BB%E5%8F%98%E6%8D%A2%E4%B8%8E%E5%88%86%E6%B0%B4%E5%B2%AD%E4%BB%8B%E7%BB%8D"><span class="toc-number">11.2.</span> <span class="toc-text">2、距离变换与分水岭介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E7%9B%B8%E5%85%B3API-1"><span class="toc-number">11.3.</span> <span class="toc-text">3、相关API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B5%81%E7%A8%8B-1"><span class="toc-number">11.4.</span> <span class="toc-text">4、流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-9"><span class="toc-number">11.5.</span> <span class="toc-text">示例代码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/07/09/14%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E7%AE%97%E6%B3%95%E6%A8%A1%E5%BC%8F/" title="14种常见的算法模式"><img src="https://file.buildworld.cn/img/20210709115216.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="14种常见的算法模式"/></a><div class="content"><a class="title" href="/2021/07/09/14%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E7%AE%97%E6%B3%95%E6%A8%A1%E5%BC%8F/" title="14种常见的算法模式">14种常见的算法模式</a><time datetime="2021-07-09T03:41:36.000Z" title="发表于 2021-07-09 11:41:36">2021-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/09/LeetCode%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%98%E7%9B%AE%E9%9B%86%E5%90%88/" title="LeetCode数据库题目集合"><img src="https://file.buildworld.cn/img/20210209161641.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LeetCode数据库题目集合"/></a><div class="content"><a class="title" href="/2021/02/09/LeetCode%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%98%E7%9B%AE%E9%9B%86%E5%90%88/" title="LeetCode数据库题目集合">LeetCode数据库题目集合</a><time datetime="2021-02-09T08:13:56.000Z" title="发表于 2021-02-09 16:13:56">2021-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/07/BigData-%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%AD%A6%E4%B9%A0/" title="BigData-数据仓库学习"><img src="https://file.buildworld.cn/img/20210107194133.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BigData-数据仓库学习"/></a><div class="content"><a class="title" href="/2021/01/07/BigData-%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%AD%A6%E4%B9%A0/" title="BigData-数据仓库学习">BigData-数据仓库学习</a><time datetime="2021-01-07T11:35:36.000Z" title="发表于 2021-01-07 19:35:36">2021-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/04/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="算法学习记录"><img src="https://file.buildworld.cn/img/20201104092750.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法学习记录"/></a><div class="content"><a class="title" href="/2020/11/04/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="算法学习记录">算法学习记录</a><time datetime="2020-11-04T01:20:49.000Z" title="发表于 2020-11-04 09:20:49">2020-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/11/BigData-%E5%88%86%E5%B8%83%E5%BC%8F%E6%B5%81%E6%95%B0%E6%8D%AE%E6%B5%81%E5%BC%95%E6%93%8EApache-Flink/" title="BigData--分布式流数据流引擎Apache Flink"><img src="https://file.buildworld.cn/img/20200911110402.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BigData--分布式流数据流引擎Apache Flink"/></a><div class="content"><a class="title" href="/2020/09/11/BigData-%E5%88%86%E5%B8%83%E5%BC%8F%E6%B5%81%E6%95%B0%E6%8D%AE%E6%B5%81%E5%BC%95%E6%93%8EApache-Flink/" title="BigData--分布式流数据流引擎Apache Flink">BigData--分布式流数据流引擎Apache Flink</a><time datetime="2020-09-11T02:59:30.000Z" title="发表于 2020-09-11 10:59:30">2020-09-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2021 By MiChong</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="//www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src="https://ae01.alicdn.com/kf/H4484324da9f8498e943e64b4cc0e602dZ.png" style="width:75px;"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'mef0W501zi4VSjltsnmN5D9J-gzGzoHsz',
      appKey: 'ktKil4OakXUNcSs0Ofkph1rm',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-cn',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "7d002c40-fe0a-44eb-977b-a992eaed1e7c";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (true) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>